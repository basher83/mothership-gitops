# ClusterSecretStores for Infisical - one per secrets path
# Requires manual secret created first:
#   kubectl create namespace external-secrets
#   kubectl create secret generic universal-auth-credentials \
#     --from-literal=clientId=<INFISICAL_CLIENT_ID> \
#     --from-literal=clientSecret=<INFISICAL_CLIENT_SECRET> \
#     -n external-secrets
---
apiVersion: external-secrets.io/v1
kind: ClusterSecretStore
metadata:
  name: infisical-tailscale
  annotations:
    argocd.argoproj.io/sync-wave: "2"
spec:
  provider:
    infisical:
      hostAPI: https://app.infisical.com
      auth:
        universalAuthCredentials:
          clientId:
            name: universal-auth-credentials
            namespace: external-secrets
            key: clientId
          clientSecret:
            name: universal-auth-credentials
            namespace: external-secrets
            key: clientSecret
      secretsScope:
        projectSlug: mothership-s0-ew
        environmentSlug: prod
        secretsPath: /tailscale-operator
---
apiVersion: external-secrets.io/v1
kind: ClusterSecretStore
metadata:
  name: infisical-netdata
  annotations:
    argocd.argoproj.io/sync-wave: "2"
spec:
  provider:
    infisical:
      hostAPI: https://app.infisical.com
      auth:
        universalAuthCredentials:
          clientId:
            name: universal-auth-credentials
            namespace: external-secrets
            key: clientId
          clientSecret:
            name: universal-auth-credentials
            namespace: external-secrets
            key: clientSecret
      secretsScope:
        projectSlug: mothership-s0-ew
        environmentSlug: prod
        secretsPath: /netdata
---
apiVersion: external-secrets.io/v1
kind: ClusterSecretStore
metadata:
  name: infisical-homarr
  annotations:
    argocd.argoproj.io/sync-wave: "2"
spec:
  provider:
    infisical:
      hostAPI: https://app.infisical.com
      auth:
        universalAuthCredentials:
          clientId:
            name: universal-auth-credentials
            namespace: external-secrets
            key: clientId
          clientSecret:
            name: universal-auth-credentials
            namespace: external-secrets
            key: clientSecret
      secretsScope:
        projectSlug: mothership-s0-ew
        environmentSlug: prod
        secretsPath: /homarr
---
apiVersion: external-secrets.io/v1
kind: ClusterSecretStore
metadata:
  name: infisical-longhorn
  annotations:
    argocd.argoproj.io/sync-wave: "2"
spec:
  provider:
    infisical:
      hostAPI: https://app.infisical.com
      auth:
        universalAuthCredentials:
          clientId:
            name: universal-auth-credentials
            namespace: external-secrets
            key: clientId
          clientSecret:
            name: universal-auth-credentials
            namespace: external-secrets
            key: clientSecret
      secretsScope:
        projectSlug: mothership-s0-ew
        environmentSlug: prod
        secretsPath: /longhorn
